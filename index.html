
<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Acil TÄ±p Asistan Bilgi YarÄ±ÅŸmasÄ±</title>

  <!-- Bootstrap 5 (CDN) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    :root{
      --bg:#f4f6f8;
      --card:#ffffff;
      --muted:#6c757d;
      --shadow: 0 10px 30px rgba(0,0,0,.08);
      --radius: 20px;
    }
    body{
      background: radial-gradient(1200px 600px at 10% 10%, #ffffff 0%, var(--bg) 55%, #eef2f6 100%);
      min-height:100vh;
    }
    .screen{ display:none; width:100%; }
    .screen.active{ display:block; }

    .topbar{
      position:sticky; top:0; z-index:10;
      background:rgba(244,246,248,.75);
      backdrop-filter: blur(10px);
      border-bottom:1px solid rgba(0,0,0,.06);
    }
    .brand-badge{
      display:inline-flex; align-items:center; gap:.6rem;
      background: var(--card);
      padding:.6rem 1rem;
      border-radius:999px;
      box-shadow: var(--shadow);
      border:1px solid rgba(0,0,0,.06);
      font-weight:700;
    }
    .stage-pill{
      font-weight:800;
      border-radius:999px;
      padding:.45rem .85rem;
      border:1px solid rgba(0,0,0,.08);
      background:#fff;
    }

    .cardx{
      background:var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border:1px solid rgba(0,0,0,.06);
    }
    .hero{ padding: clamp(1rem, 3vw, 2.2rem); }
    .title{
      font-weight:900;
      letter-spacing:-.02em;
      line-height:1.05;
      font-size: clamp(2rem, 4.5vw, 3.6rem);
    }
    .subtitle{ color:var(--muted); font-size: clamp(1rem, 1.6vw, 1.15rem); }
    .btn-xl{
      padding: .95rem 1.25rem;
      border-radius: 14px;
      font-weight: 800;
      letter-spacing:.02em;
    }

    .question-wrap{ padding: clamp(1rem, 2.5vw, 2rem); }
    .q-text{
      font-size: clamp(1.2rem, 2.2vw, 2rem);
      font-weight: 850;
      letter-spacing: -.01em;
    }
    .option-btn{
  text-align:left;
  width:100%;
  border-radius: 16px;
  padding: 1.05rem 1.1rem;
  font-weight: 800;

  background: #f8f9fb;                 /* âœ… hafif gri arkaplan */
  border: 2px solid rgba(0,0,0,.10);    /* âœ… daha belirgin sÄ±nÄ±r */
  color: #212529;                       /* âœ… yazÄ± koyu */
  
  transition: transform .12s ease, box-shadow .12s ease, background-color .12s ease, border-color .12s ease;
}

.option-btn:hover{
  transform: translateY(-2px);
  box-shadow: 0 14px 26px rgba(0,0,0,.08);
  background: #ffffff;
  border-color: rgba(0,0,0,.18);
}

.option-btn:disabled{
  opacity: 1;
  cursor: default;
  transform: none;
  box-shadow: none;
}

.opt-letter{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width: 38px;
  height: 38px;
  border-radius: 12px;
  margin-right: 12px;
  font-weight: 900;
  background: rgba(0,0,0,.08);
  border: 1px solid rgba(0,0,0,.10);
}
    

    .timer-badge{
      font-variant-numeric: tabular-nums;
      font-weight: 950;
      font-size: clamp(2.2rem, 5vw, 4.2rem);
      letter-spacing: -.04em;
      line-height: 1;
    }
    .meta-chip{
      border-radius: 999px;
      padding: .45rem .75rem;
      font-weight: 850;
      border:1px solid rgba(0,0,0,.08);
      background:#fff;
      display:inline-flex; align-items:center; gap:.5rem;
      white-space:nowrap;
    }
    .chip-dot{
      width:10px; height:10px; border-radius:999px; display:inline-block;
      box-shadow: 0 0 0 3px rgba(0,0,0,.04);
    }

    .table thead th{ font-weight:900; }
   .rank-1 > *{ background-color: rgba(25,135,84,.10) !important; }
.rank-2 > *{ background-color: rgba(13,110,253,.08) !important; }
.rank-3 > *{ background-color: rgba(255,193,7,.12) !important; }
.rank-4 > *{ background-color: rgba(108,117,125,.10) !important; }

    .footer-note{ color:var(--muted); font-size:.95rem; }

   /* âœ… Ãœst tur / elenen renkleri (live scoreboard) */
.live-qualify > *{
  background-color: rgba(25,135,84,.12) !important;   /* aÃ§Ä±k yeÅŸil */
}

.live-eliminate > *{
  background-color: rgba(220,53,69,.10) !important;   /* aÃ§Ä±k kÄ±rmÄ±zÄ± */
}

    @media (min-width: 992px){
      .two-col{
        display:grid;
        grid-template-columns: 1.2fr .8fr;
        gap: 1.25rem;
        align-items:stretch;
      }
    }

/* âœ… Kongre sahne modu: kategoriye gÃ¶re arka plan tonu */
.arena{
  transition: background-color .25s ease, border-color .25s ease, box-shadow .25s ease;
}
.bg-yesil{
  background: linear-gradient(180deg, rgba(25,135,84,.10), rgba(255,255,255,1));
  border-color: rgba(25,135,84,.20) !important;
  box-shadow: 0 12px 30px rgba(25,135,84,.10);
}
.bg-sari{
  background: linear-gradient(180deg, rgba(255,193,7,.14), rgba(255,255,255,1));
  border-color: rgba(255,193,7,.25) !important;
  box-shadow: 0 12px 30px rgba(255,193,7,.12);
}
.bg-kirmizi{
  background: linear-gradient(180deg, rgba(220,53,69,.10), rgba(255,255,255,1));
  border-color: rgba(220,53,69,.22) !important;
  box-shadow: 0 12px 30px rgba(220,53,69,.10);
}
.bg-bonus{
  background: linear-gradient(180deg, rgba(13,110,253,.10), rgba(255,255,255,1));
  border-color: rgba(13,110,253,.22) !important;
  box-shadow: 0 12px 30px rgba(13,110,253,.10);
}

/* âœ… Tie-break sahne modu */
.bg-tiebreak{
  background: linear-gradient(180deg, rgba(111,66,193,.12), rgba(255,255,255,1)); /* aÃ§Ä±k mor */
  border-color: rgba(111,66,193,.25) !important;
  box-shadow: 0 12px 30px rgba(111,66,193,.12);
}

    /* AÃ§Ä±lÄ±ÅŸ ekranÄ± kongre banner */
.congress-banner{
  margin-top: 1.5rem;
  border-radius: 18px;
  overflow: hidden;
  box-shadow: 0 12px 30px rgba(0,0,0,.10);
  border: 1px solid rgba(0,0,0,.06);
}

.congress-banner img{
  width: 100%;
  height: auto;
  display: block;
  object-fit: cover;
}

    /* Kurallar kartÄ± alt banner */
.rules-banner{
  margin-top: 1.25rem;
  border-radius: 14px;
  overflow: hidden;
  border: 1px solid rgba(0,0,0,.06);
  box-shadow: 0 8px 20px rgba(0,0,0,.08);
}

.rules-banner img{
  width: 100%;
  height: auto;
  display: block;
  object-fit: cover;
}

    #btnStart:disabled{
  opacity: 1;          /* soluklaÅŸmasÄ±n */
  cursor: default;
  pointer-events: none;
  background: #212529;
  border-color: #212529;
}

    /* Welcome banner alanÄ±: ekrana sÄ±ÄŸdÄ±r */
.welcome-banner{
  margin-top: 1rem;
  border-radius: 18px;
  overflow: hidden;
  border: 1px solid rgba(0,0,0,.06);
  box-shadow: 0 12px 30px rgba(0,0,0,.12);

  /* ğŸ”¥ Daha bÃ¼yÃ¼k banner */
  height: min(55vh, 500px);
}

.welcome-banner img{
  width: 100%;
  height: 100%;
  object-fit: cover;        /* taÅŸanÄ± kÄ±rpar, banner gibi durur */
  display: block;
}
    
  </style>
</head>

<body>
  <!-- TOPBAR -->
  <div class="topbar py-3">
    <div class="container-fluid px-3 px-md-4 d-flex align-items-center justify-content-between">
      <div class="brand-badge">
        <span class="badge text-bg-dark rounded-pill">ATUDER</span>
        <span>Acil TÄ±p Asistan Bilgi YarÄ±ÅŸmasÄ± 2026 | yamizey yazÄ±lÄ±m | Â© TÃ¼m haklarÄ± saklÄ±dÄ±r.</span>
      </div>
      <div class="d-flex align-items-center gap-2">
        <span id="stagePill" class="stage-pill d-none">AÅAMA</span>
        <span id="subStagePill" class="stage-pill d-none">â€”</span>
      </div>
    </div>
  </div>

  <div class="container-fluid px-3 px-md-4 py-4">
    <!-- SCREEN: WELCOME -->
    <section id="screenWelcome" class="screen active">
      <div class="cardx hero">
        <div class="row align-items-center g-4">
          <div class="col-lg-7">
            <div class="title">Åimdi Bilgi YarÄ±ÅŸmasÄ± ZamanÄ±!</div>
            <p class="subtitle mt-3 mb-0">
              2026 Acil TÄ±p Asistan Bilgi YarÄ±ÅŸmasÄ±
            </p>
          </div>
          <div class="col-lg-5">
            <div class="cardx p-4">
              <div class="d-grid gap-2">
                <button id="btnStart" class="btn btn-dark btn-xl" disabled>HOÅ GELDÄ°NÄ°Z!</button>
                <button id="btnDemoFill" class="btn btn-outline-secondary btn-xl">
                  TakÄ±m Ä°simlerini Girin
                </button>
              </div>
              <div class="footer-note mt-3">
                <center><b>TasarÄ±m ve Kodlama:</b> Uzm.Dr.Mine KayacÄ± YÄ±ldÄ±z - Uzm.Dr.Yasin YÄ±ldÄ±z</center>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- âœ… KONGRE BANNER -->
  <div class="welcome-banner">
  <img src="https://acil42.com/wp-content/uploads/2026/02/Ekran-Resmi-2026-02-13-18.11.12.png"
       alt="April Congress 2026">
</div>
    </section>

    <!-- SCREEN: TEAMS -->
    <section id="screenTeams" class="screen">
      <div class="two-col">
        <div class="cardx p-4">
          <h2 class="fw-bold mb-2">YarÄ±ÅŸmadaki TakÄ±mlar:</h2>
          <p class="text-secondary mb-4">TakÄ±m isimlerini buraya yazÄ±n.</p>

          <div class="row g-3 align-items-end">
            <div class="col-md-9">
              <label class="form-label fw-bold">TakÄ±m Listesi</label>
              <textarea id="teamTextarea" class="form-control" rows="10" placeholder="Ã–rn:
Konya City
Ankara ResÃ¼s
Ä°zmir Åok
..."></textarea>
            </div>
            <div class="col-md-3">
              <div class="d-grid gap-2">
                <button id="btnParseTeams" class="btn btn-primary btn-xl">TakÄ±mlarÄ± Kaydet</button>
                <button id="btnClearTeams" class="btn btn-outline-secondary btn-xl">Temizle</button>
              </div>
            </div>
          </div>

          <hr class="my-4"/>

          <div class="d-flex flex-wrap gap-2 align-items-center justify-content-between">
            <div class="text-secondary">
              <span class="fw-bold">HER AÅAMA:</span> 1 YeÅŸil + 2 SarÄ± + 1 KÄ±rmÄ±zÄ± + 1 Bonus (Toplam 5 soru)<br>
              <span class="fw-bold">TOPLAM 3 AÅAMA:</span> 3 YeÅŸil + 6 SarÄ± + 3 KÄ±rmÄ±zÄ± + 3 Bonus (Toplam 15 soru)
            </div>
            <button id="btnBeginStage1" class="btn btn-dark btn-xl" disabled>YARIÅMAYA BAÅLA</button>
          </div>
        </div>

        <div class="cardx p-4">
          <h4 class="fw-bold">Kurallar / Puanlama</h4>
          <ul class="mb-0">
            <li>YeÅŸil kategori: <span class="fw-bold">10</span> puan</li>
            <li>SarÄ± kategori: <span class="fw-bold">15</span> puan</li>
            <li>KÄ±rmÄ±zÄ± kategori: <span class="fw-bold">25</span> puan</li>
            <li>Bonus kategori: <span class="fw-bold">5</span> puan</li>
            <li>Her soru iÃ§in sÃ¼re: <span class="fw-bold">30 sn</span></li>
            <li>Eleme eÅŸitliklerinde <span class="fw-bold">bonus tie-break</span> sorusu sorulur.</li>
            <li>TasarÄ±m ve kodlama: <br><span class="fw-bold">Uzm.Dr.Mine KayacÄ± YÄ±ldÄ±z ve Uzm.Dr.Yasin YÄ±ldÄ±z</span>.</li>
          </ul>
          <!-- Kongre Banner -->
<div class="rules-banner">
  <img src="https://acil42.com/wp-content/uploads/2026/02/Ekran-Resmi-2026-02-13-18.11.12.png"
       alt="April Congress 2026">
</div>
        </div>
      </div>
    </section>

    <!-- SCREEN: QUESTION -->
    <section id="screenQuestion" class="screen">
      <div class="two-col">

        <div class="cardx question-wrap arena" id="arenaCard">
          <div class="d-flex flex-wrap align-items-center justify-content-between gap-2">
            <div class="d-flex flex-wrap gap-2 align-items-center">
              <span id="chipCategory" class="badge fs-6 px-3 py-2">
  KATEGORÄ°
</span>
              <span id="chipPoints" class="meta-chip">
                <span class="badge text-bg-dark rounded-pill">PUAN</span>
                <span id="txtPoints">0</span>
              </span>
              <span id="chipQCounter" class="meta-chip">
                <span class="badge text-bg-secondary rounded-pill">SORU</span>
                <span id="txtQCounter">1/5</span>
              </span>
              <span id="chipMode" class="meta-chip d-none">
                <span class="badge text-bg-warning rounded-pill">TIE-BREAK</span>
                <span id="txtMode">BONUS</span>
              </span>
            </div>

            <div class="text-end">
              <div id="timerBig" class="timer-badge">30</div>
              <div class="text-secondary fw-bold">saniye</div>
            </div>
          </div>

          <div class="progress mt-3" style="height:10px;">
            <div id="timerBar" class="progress-bar" role="progressbar" style="width:100%"></div>
          </div>

          <hr class="my-4"/>

          <div id="questionText" class="q-text mb-3">Soru metni...</div>

          <div class="d-grid gap-2">
            <button class="option-btn" id="optA"></button>
            <button class="option-btn" id="optB"></button>
            <button class="option-btn" id="optC"></button>
            <button class="option-btn" id="optD"></button>
          </div>

          <hr class="my-4"/>

          <div class="d-flex flex-wrap gap-2">
            <button id="btnShowAnswer" class="btn btn-success btn-xl d-none">CEVABI GÃ–STER</button>
            <button id="btnEnterPoints" class="btn btn-primary btn-xl d-none" data-bs-toggle="modal" data-bs-target="#pointsModal">
              PUAN GÄ°R
            </button>
            <button id="btnNextQuestion" class="btn btn-dark btn-xl d-none">SONRAKÄ° SORU</button>
            <button id="btnStartTimer" class="btn btn-warning btn-xl ms-auto">SÃœREYÄ° BAÅLAT</button>
          </div>

          <div class="footer-note mt-3">
            Â© Web uygulamasÄ±nÄ±n tÃ¼m haklarÄ± saklÄ±dÄ±r.
          </div>
        </div>

        <div class="cardx p-4">
          <div class="d-flex align-items-center justify-content-between">
            <h4 class="fw-bold mb-0">AnlÄ±k Puan Tablosu</h4>
            <span class="badge text-bg-dark rounded-pill" id="activeTeamsBadge">0 takÄ±m</span>
          </div>
          <div class="table-responsive mt-3">
            <table class="table table-hover align-middle">
              <thead>
                <tr>
                  <th style="width:60px;">#</th>
                  <th>TakÄ±m</th>
                  <th class="text-end">Puan</th>
                </tr>
              </thead>
              <tbody id="liveScoreBody"></tbody>
            </table>
          </div>
          <div class="footer-note">Bu tablo, her â€œPUAN GÄ°Râ€ iÅŸleminden sonra gÃ¼ncellenir.</div>
        </div>

      </div>
    </section>

    <!-- SCREEN: SCOREBOARD -->
    <section id="screenScoreboard" class="screen">
      <div class="cardx p-4">
        <div class="d-flex flex-wrap align-items-end justify-content-between gap-3">
          <div>
            <h2 id="scoreboardTitle" class="fw-bold mb-1">Puan Tablosu</h2>
            <div id="scoreboardSubtitle" class="text-secondary">â€”</div>
          </div>
          <div class="d-flex flex-wrap gap-2">
            <button id="btnProceedNextStage" class="btn btn-dark btn-xl d-none">DEVAM</button>
            <button id="btnBackToTeams" class="btn btn-outline-secondary btn-xl">BaÅŸa DÃ¶n</button>
          </div>
        </div>

        <hr class="my-3"/>

        <div class="table-responsive">
          <table class="table table-hover align-middle">
            <thead>
              <tr>
                <th style="width:70px;">SÄ±ra</th>
                <th>TakÄ±m</th>
                <th class="text-end">Toplam Puan</th>
                <th class="text-end">Durum</th>
              </tr>
            </thead>
            <tbody id="finalScoreBody"></tbody>
          </table>
        </div>

        <div id="tieInfo" class="alert alert-warning d-none mt-3 mb-0">
          SÄ±ralama eÅŸitliÄŸi var. Bonus tie-break sorularÄ±na geÃ§ilecek.
        </div>
      </div>
    </section>
  </div>

  <!-- MODAL: POINTS ENTRY -->
  <div class="modal fade" id="pointsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content" style="border-radius:18px;">
        <div class="modal-header">
          <h5 class="modal-title fw-bold">Puan Gir (Bu Soru)</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Kapat"></button>
        </div>
        <div class="modal-body">
          <div class="alert alert-secondary">
            Bu soru doÄŸru cevaplayanlara <span class="fw-bold" id="modalMaxPoints">0</span> puan yazar.
          </div>

          <div class="table-responsive">
            <table class="table align-middle">
              <thead>
                <tr>
                  <th>TakÄ±m</th>
                  <th class="text-end" style="width:180px;">Bu Sorudan</th>
                </tr>
              </thead>
              <tbody id="pointsEntryBody"></tbody>
            </table>
          </div>

          <div class="footer-note">
            Tie-break modunda sadece eÅŸitliÄŸi bozmaya aday takÄ±mlar listelenir.
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-secondary btn-xl" data-bs-dismiss="modal">Ä°ptal</button>
          <button type="button" id="btnSavePoints" class="btn btn-primary btn-xl" data-bs-dismiss="modal">Kaydet</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS (CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    /***********************
     *  CONFIG & QUESTION DB
     ***********************/
    const CATEGORY = {
      YESIL: { key:'YESIL', label:'YEÅÄ°L', points:10, dot:'#198754' },
      SARI:  { key:'SARI',  label:'SARI',  points:15, dot:'#ffc107' },
      KIRMIZI:{key:'KIRMIZI',label:'KIRMIZI',points:25, dot:'#dc3545' },
      BONUS: { key:'BONUS', label:'BONUS', points:5, dot:'#0d6efd' }
    };

    // Soru formatÄ±:
    // { id, categoryKey, question, options:{A,B,C,D}, answer:'A'|'B'|'C'|'D' }
    // Buraya kendi gerÃ§ek sorularÄ±nÄ±zÄ± aynÄ± formatta ekleyebilirsiniz.
    function generatePlaceholderQuestions(){
      const makeQ = (catKey, n, startIdx=1) => {
        const out = [];
        for(let i=0;i<n;i++){
          const idx = startIdx+i;
          const id = `${catKey}-${idx}`;
          out.push({
            id,
            categoryKey: catKey,
            question: `[${CATEGORY[catKey].label}] Ã–rnek Soru ${idx}: Acil tÄ±p bilgisi ile ilgili doÄŸru ifade hangisidir?`,
            options: {
              A: `SeÃ§enek A (${CATEGORY[catKey].label} ${idx})`,
              B: `SeÃ§enek B (${CATEGORY[catKey].label} ${idx})`,
              C: `SeÃ§enek C (${CATEGORY[catKey].label} ${idx})`,
              D: `SeÃ§enek D (${CATEGORY[catKey].label} ${idx})`,
            },
            answer: ['A','B','C','D'][Math.floor(Math.random()*4)]
          });
        }
        return out;
      };
      return [
        ...makeQ('YESIL', 20, 1),
        ...makeQ('SARI', 20, 1),
        ...makeQ('KIRMIZI', 20, 1),
        ...makeQ('BONUS', 10, 1),
      ];
    }
/*SORULAR BURADA*/
    
    let QUESTION_BANK = [
  // =========================
  // âœ… YEÅÄ°L (20 soru) â€” 10 puan
  // =========================
  {
    id: "YESIL-001",
    categoryKey: "YESIL",
    question: "Anafilakside ilk basamak ilaÃ§ hangisidir?",
    options: { A: "IV steroid", B: "IM adrenalin", C: "IV antihistaminik", D: "NebÃ¼l salbutamol" },
    answer: "B"
  },
  {
    id: "YESIL-002",
    categoryKey: "YESIL",
    question: "EriÅŸkin hipoglisemide acilde sÄ±k kullanÄ±lan IV dekstroz konsantrasyonu hangisidir?",
    options: { A: "%5", B: "%10", C: "%20", D: "%50" },
    answer: "D"
  },
  {
    id: "YESIL-003",
    categoryKey: "YESIL",
    question: "Acil serviste triyajda 'KÄ±rmÄ±zÄ±' alan genel olarak neyi ifade eder?",
    options: { A: "Acil olmayan", B: "Gecikebilir", C: "HayatÄ± tehdit eden", D: "Kontrol randevusu" },
    answer: "C"
  },
  {
    id: "YESIL-004",
    categoryKey: "YESIL",
    question: "Acil serviste el hijyeni iÃ§in en temel yÃ¶ntem hangisidir?",
    options: { A: "Eldiven giymek", B: "Alkol bazlÄ± el antiseptiÄŸi", C: "Sadece suyla yÄ±kamak", D: "Maske takmak" },
    answer: "B"
  },
  {
    id: "YESIL-005",
    categoryKey: "YESIL",
    question: "Oksijen satÃ¼rasyonu (SpO2) Ã¶lÃ§Ã¼mÃ¼ en sÄ±k hangi yÃ¶ntemle yapÄ±lÄ±r?",
    options: { A: "Kapnografi", B: "Pulse oksimetre", C: "Arteriyel kan gazÄ±", D: "EKG" },
    answer: "B"
  },
  {
    id: "YESIL-006",
    categoryKey: "YESIL",
    question: "GKS (Glasgow Koma Skoru) hangi Ã¼Ã§ bileÅŸenden oluÅŸur?",
    options: { A: "AteÅŸâ€“nabÄ±zâ€“solunum", B: "GÃ¶zâ€“motorâ€“sÃ¶zel", C: "AÄŸrÄ±â€“refleksâ€“pupil", D: "BilinÃ§â€“dengeâ€“konuÅŸma" },
    answer: "B"
  },
  {
    id: "YESIL-007",
    categoryKey: "YESIL",
    question: "Acilde ÅŸok deÄŸerlendirmesinde en temel vital bulgu hangisidir?",
    options: { A: "Boy", B: "AÄŸÄ±rlÄ±k", C: "Kan basÄ±ncÄ±", D: "GÃ¶z rengi" },
    answer: "C"
  },
  {
    id: "YESIL-008",
    categoryKey: "YESIL",
    question: "Ä°ntravenÃ¶z (IV) yol aÃ§manÄ±n temel amacÄ± hangisidir?",
    options: { A: "AÄŸrÄ± azaltmak", B: "Ä°laÃ§/sÄ±vÄ± uygulamak", C: "AteÅŸi dÃ¼ÅŸÃ¼rmek", D: "Solunumu artÄ±rmak" },
    answer: "B"
  },
  {
    id: "YESIL-009",
    categoryKey: "YESIL",
    question: "Akut aÄŸrÄ± kontrolÃ¼nde ilk deÄŸerlendirmede en Ã§ok hangisi sorgulanÄ±r?",
    options: { A: "SaÃ§ rengi", B: "AÄŸrÄ±nÄ±n ÅŸiddeti", C: "EÄŸitim durumu", D: "Meslek" },
    answer: "B"
  },
  {
    id: "YESIL-010",
    categoryKey: "YESIL",
    question: "Acilde travmada ilk yaklaÅŸÄ±mÄ±n temel prensibi hangisidir?",
    options: { A: "DetaylÄ± Ã¶ykÃ¼", B: "ABC yaklaÅŸÄ±mÄ±", C: "Sadece laboratuvar", D: "Sadece MR" },
    answer: "B"
  },
  {
    id: "YESIL-011",
    categoryKey: "YESIL",
    question: "KPRâ€™de gÃ¶ÄŸÃ¼s kompresyonunun yeri neresidir?",
    options: { A: "Sol meme ucu", B: "Sternumun alt yarÄ±sÄ±", C: "SaÄŸ kostalar", D: "Ksifoid" },
    answer: "B"
  },
  {
    id: "YESIL-012",
    categoryKey: "YESIL",
    question: "Tansiyon pnÃ¶motoraks ÅŸÃ¼phesinde klinikte en Ã¶ncelikli yaklaÅŸÄ±m hangisidir?",
    options: { A: "AkciÄŸer grafisi beklemek", B: "BT Ã§ekmek", C: "Klinik tanÄ± ile acil dekompresyon", D: "Antibiyotik baÅŸlamak" },
    answer: "C"
  },
  {
    id: "YESIL-013",
    categoryKey: "YESIL",
    question: "Acilde ateÅŸ Ã¶lÃ§Ã¼mÃ¼ iÃ§in en pratik yÃ¶ntemlerden biri hangisidir?",
    options: { A: "CT", B: "Timpan termometre", C: "EKG", D: "USG" },
    answer: "B"
  },
  {
    id: "YESIL-014",
    categoryKey: "YESIL",
    question: "Ciddi alerjik reaksiyonda hastanÄ±n pozisyonu iÃ§in genel Ã¶neri hangisidir?",
    options: { A: "Ayakta bekletme", B: "Supin + bacaklarÄ± yÃ¼kseltme (uygunsa)", C: "YÃ¼zÃ¼stÃ¼ yatÄ±rma", D: "SÃ¼rekli yÃ¼rÃ¼tme" },
    answer: "B"
  },
  {
    id: "YESIL-015",
    categoryKey: "YESIL",
    question: "SpO2 dÃ¼ÅŸÃ¼kse ilk yapÄ±lacaklardan biri hangisidir?",
    options: { A: "Hemen taburcu", B: "Oksijen desteÄŸi baÅŸlamak", C: "Sadece kan ÅŸekeri bakmak", D: "Sadece idrar tahlili" },
    answer: "B"
  },
  {
    id: "YESIL-016",
    categoryKey: "YESIL",
    question: "Acilde bilinÃ§ bozukluÄŸunda hÄ±zlÄ± deÄŸerlendirmede ilklerden biri hangisidir?",
    options: { A: "HbA1c", B: "Kan ÅŸekeri Ã¶lÃ§Ã¼mÃ¼", C: "Kolesterol", D: "D vitamini" },
    answer: "B"
  },
  {
    id: "YESIL-017",
    categoryKey: "YESIL",
    question: "Åiddetli aÄŸrÄ±lÄ± travmalÄ± hastada analjezi yaklaÅŸÄ±mÄ± iÃ§in doÄŸru ifade hangisidir?",
    options: { A: "Analjezi geciktirilmelidir", B: "AÄŸrÄ± kontrolÃ¼ erken planlanabilir", C: "Sadece sedasyon yapÄ±lÄ±r", D: "AÄŸrÄ± deÄŸerlendirilmez" },
    answer: "B"
  },
  {
    id: "YESIL-018",
    categoryKey: "YESIL",
    question: "IV sÄ±vÄ± tedavisinde ilk tercih kristalloidlerden hangisidir?",
    options: { A: "SÃ¼t", B: "Serum fizyolojik / dengeli kristalloid", C: "Kahve", D: "Meyve suyu" },
    answer: "B"
  },
  {
    id: "YESIL-019",
    categoryKey: "YESIL",
    question: "Acilde hastanÄ±n kimlik doÄŸrulamasÄ± iÃ§in temel yÃ¶ntem hangisidir?",
    options: { A: "Tahmin etmek", B: "Bileklik / kimlik kontrolÃ¼", C: "YanÄ±ndaki kiÅŸiye sormamak", D: "Sadece dosyaya bakmak" },
    answer: "B"
  },
  {
    id: "YESIL-020",
    categoryKey: "YESIL",
    question: "KPR sÄ±rasÄ±nda ventilasyon iÃ§in temel amaÃ§ hangisidir?",
    options: { A: "Hipoksemi dÃ¼zeltmek", B: "Hipertansiyon yapmak", C: "AÄŸrÄ±yÄ± azaltmak", D: "AteÅŸi dÃ¼ÅŸÃ¼rmek" },
    answer: "A"
  },

  // =========================
  // âœ… SARI (20 soru) â€” 15 puan
  // =========================
  {
    id: "SARI-001",
    categoryKey: "SARI",
    question: "Inferior ST elevasyonlu MIâ€™da saÄŸ ventrikÃ¼l MIâ€™Ä± dÃ¼ÅŸÃ¼ndÃ¼ren en Ã¶nemli derivasyon hangisidir?",
    options: { A: "V1", B: "V3", C: "V4R", D: "aVL" },
    answer: "C"
  },
  {
    id: "SARI-002",
    categoryKey: "SARI",
    question: "Sepsis-3â€™e gÃ¶re sepsis tanÄ±mÄ± hangisidir?",
    options: { A: "AteÅŸ + lÃ¶kositoz", B: "Enfeksiyona yanÄ±t olarak organ disfonksiyonu", C: "Hipotansiyon + taÅŸikardi", D: "CRP yÃ¼ksekliÄŸi" },
    answer: "B"
  },
  {
    id: "SARI-003",
    categoryKey: "SARI",
    question: "Pulmoner emboli olasÄ±lÄ±ÄŸÄ± dÃ¼ÅŸÃ¼k hastada dÄ±ÅŸlama iÃ§in kullanÄ±lan klinik araÃ§lardan biri hangisidir?",
    options: { A: "PERC", B: "APGAR", C: "MELD", D: "CHADS2" },
    answer: "A"
  },
  {
    id: "SARI-004",
    categoryKey: "SARI",
    question: "Akut inmede tromboliz iÃ§in en kritik unsurlardan biri hangisidir?",
    options: { A: "Hasta boyu", B: "Semptom baÅŸlangÄ±Ã§ zamanÄ±", C: "SaÃ§ rengi", D: "Kan grubu" },
    answer: "B"
  },
  {
    id: "SARI-005",
    categoryKey: "SARI",
    question: "Kafa travmasÄ±nda BT endikasyonunda sÄ±k kullanÄ±lan karar kuralÄ± hangisidir?",
    options: { A: "Wells", B: "Canadian CT Head Rule", C: "PERC", D: "Ottawa Ankle" },
    answer: "B"
  },
  {
    id: "SARI-006",
    categoryKey: "SARI",
    question: "Akut astÄ±m ataÄŸÄ±nda ilk basamak inhaler tedavilerden biri hangisidir?",
    options: { A: "NebÃ¼l salbutamol", B: "NebÃ¼l lidokain", C: "IM penisilin", D: "IV heparin" },
    answer: "A"
  },
  {
    id: "SARI-007",
    categoryKey: "SARI",
    question: "Akut koroner sendromda ilk deÄŸerlendirmede mutlaka istenen tetkik hangisidir?",
    options: { A: "EKG", B: "D vitamini", C: "Kemik dansitometre", D: "MR omuz" },
    answer: "A"
  },
  {
    id: "SARI-008",
    categoryKey: "SARI",
    question: "CO zehirlenmesinde pulse oksimetre Ã¶lÃ§Ã¼mÃ¼ ile ilgili doÄŸru ifade hangisidir?",
    options: { A: "Her zaman dÃ¼ÅŸÃ¼k gÃ¶sterir", B: "Normal/yanÄ±ltÄ±cÄ± olabilir", C: "COHbâ€™yi doÄŸrudan Ã¶lÃ§er", D: "TanÄ± koydurucudur" },
    answer: "B"
  },
  {
    id: "SARI-009",
    categoryKey: "SARI",
    question: "Akut Ã¼st GIS kanamasÄ±nda risk sÄ±nÄ±flamasÄ±nda kullanÄ±lan skorlardan biri hangisidir?",
    options: { A: "Glasgow-Blatchford", B: "CHA2DS2-VASc", C: "SOFA", D: "APGAR" },
    answer: "A"
  },
  {
    id: "SARI-010",
    categoryKey: "SARI",
    question: "Akut pankreatitte ilk gÃ¶rÃ¼ntÃ¼lemede sÄ±klÄ±kla tercih edilen yÃ¶ntem hangisidir?",
    options: { A: "Direkt grafi", B: "USG", C: "Kemik sintigrafisi", D: "Anjiyografi (rutin)" },
    answer: "B"
  },
  {
    id: "SARI-011",
    categoryKey: "SARI",
    question: "Gebe hastada ÅŸok tablosunda ilk yaklaÅŸÄ±m iÃ§in doÄŸru ifade hangisidir?",
    options: { A: "Anne stabilitesi Ã¶nceliklidir", B: "Sadece fetal deÄŸerlendirme", C: "IV yol aÃ§Ä±lmaz", D: "Oksijen verilmez" },
    answer: "A"
  },
  {
    id: "SARI-012",
    categoryKey: "SARI",
    question: "Akut apandisit ÅŸÃ¼phesinde ilk basamak gÃ¶rÃ¼ntÃ¼leme seÃ§eneÄŸi (Ã¶zellikle genÃ§/gebede) hangisidir?",
    options: { A: "USG", B: "PET", C: "Direkt grafi", D: "EKO" },
    answer: "A"
  },
  {
    id: "SARI-013",
    categoryKey: "SARI",
    question: "Akut menenjit ÅŸÃ¼phesinde ampirik antibiyotik baÅŸlama zamanlamasÄ± iÃ§in doÄŸru yaklaÅŸÄ±m hangisidir?",
    options: { A: "BTâ€™den sonra gÃ¼nlerce beklenir", B: "Geciktirilmeden baÅŸlanÄ±r", C: "Sadece kÃ¼ltÃ¼r sonucu beklenir", D: "HiÃ§ baÅŸlanmaz" },
    answer: "B"
  },
  {
    id: "SARI-014",
    categoryKey: "SARI",
    question: "Hiperkalemide EKGâ€™de gÃ¶rÃ¼lebilecek deÄŸiÅŸikliklerden biri hangisidir?",
    options: { A: "U dalgasÄ± belirginleÅŸir", B: "Sivri (tented) T dalgalarÄ±", C: "PR kÄ±salÄ±r", D: "QT uzamaz" },
    answer: "B"
  },
  {
    id: "SARI-015",
    categoryKey: "SARI",
    question: "Hiponatremide hÄ±zlÄ± dÃ¼zeltmenin en Ã¶nemli komplikasyonu hangisidir?",
    options: { A: "Hepatit", B: "Osmotik demiyelinizasyon", C: "PnÃ¶moni", D: "BÃ¶brek taÅŸÄ±" },
    answer: "B"
  },
  {
    id: "SARI-016",
    categoryKey: "SARI",
    question: "Akut inmede ilk gÃ¶rÃ¼ntÃ¼leme (tromboliz Ã¶ncesi) genellikle hangisidir?",
    options: { A: "KontrastsÄ±z beyin BT", B: "Direkt karÄ±n grafisi", C: "Beyin MR (her zaman)", D: "USG karotis (ilk)" },
    answer: "A"
  },
  {
    id: "SARI-017",
    categoryKey: "SARI",
    question: "Anafilakside adrenalin uygulama yolu (ilk tercih) hangisidir?",
    options: { A: "IV bolus", B: "IM", C: "SC", D: "Oral" },
    answer: "B"
  },
  {
    id: "SARI-018",
    categoryKey: "SARI",
    question: "Akut KOAH alevlenmesinde ilk basamak tedavilerden biri hangisidir?",
    options: { A: "NebÃ¼l bronkodilatÃ¶r", B: "YalnÄ±zca antibiyotik", C: "Sadece diÃ¼retik", D: "Sadece sedasyon" },
    answer: "A"
  },
  {
    id: "SARI-019",
    categoryKey: "SARI",
    question: "DKAâ€™da (diyabetik ketoasidoz) ilk yaklaÅŸÄ±mÄ±n temel bileÅŸeni hangisidir?",
    options: { A: "SÄ±vÄ± resÃ¼sitasyonu", B: "Sadece antibiyotik", C: "Sadece analjezi", D: "Sadece antiemetik" },
    answer: "A"
  },
  {
    id: "SARI-020",
    categoryKey: "SARI",
    question: "Akut epigastrik aÄŸrÄ±da aort diseksiyonu ÅŸÃ¼phesinde hÄ±zlÄ± tarama iÃ§in Ã¶nemli fizik bulgu hangisidir?",
    options: { A: "Kulak aÄŸrÄ±sÄ±", B: "Kollar arasÄ± tansiyon farkÄ±", C: "DÃ¶kÃ¼ntÃ¼", D: "Dil pasÄ±" },
    answer: "B"
  },

  // =========================
  // âœ… KIRMIZI (20 soru) â€” 25 puan
  // =========================
  {
    id: "KIRMIZI-001",
    categoryKey: "KIRMIZI",
    question: "Refrakter VF/pVTâ€™de (ACLS) antiaritmik seÃ§eneklerden biri hangisidir?",
    options: { A: "Adenozin", B: "Amiodaron", C: "Verapamil", D: "Digoksin" },
    answer: "B"
  },
  {
    id: "KIRMIZI-002",
    categoryKey: "KIRMIZI",
    question: "Tansiyon pnÃ¶motoraksta en uygun acil yaklaÅŸÄ±m hangisidir?",
    options: { A: "Nazal O2", B: "Antibiyotik", C: "Ä°ÄŸne dekompresyonu", D: "YalnÄ±z gÃ¶zlem" },
    answer: "C"
  },
  {
    id: "KIRMIZI-003",
    categoryKey: "KIRMIZI",
    question: "Anafilakside IV bolus adrenalin hangi durumda daha Ã§ok dÃ¼ÅŸÃ¼nÃ¼lÃ¼r?",
    options: { A: "Hafif Ã¼rtiker", B: "AÄŸÄ±r ÅŸok/kalp durmasÄ±", C: "Sadece rinit", D: "Sadece kaÅŸÄ±ntÄ±" },
    answer: "B"
  },
  {
    id: "KIRMIZI-004",
    categoryKey: "KIRMIZI",
    question: "KPRâ€™de defibrilasyon endikasyonu olan ritimler hangileridir?",
    options: { A: "Asistoli ve PEA", B: "SinÃ¼s taÅŸikardi", C: "VF ve pVT", D: "AF ve SVT" },
    answer: "C"
  },
  {
    id: "KIRMIZI-005",
    categoryKey: "KIRMIZI",
    question: "Status epileptikus tanÄ±mÄ± iÃ§in sÄ±k kullanÄ±lan sÃ¼re eÅŸiklerinden biri hangisidir?",
    options: { A: "30 saniye", B: "1 dakika", C: "5 dakika", D: "60 dakika" },
    answer: "C"
  },
  {
    id: "KIRMIZI-006",
    categoryKey: "KIRMIZI",
    question: "Akut masif hemoptizide acil yaklaÅŸÄ±mda en kritik hedeflerden biri hangisidir?",
    options: { A: "Hasta aÃ§ bÄ±rakÄ±lÄ±r", B: "Hava yolunu korumak", C: "Sadece sedasyon", D: "Antihistaminik vermek" },
    answer: "B"
  },
  {
    id: "KIRMIZI-007",
    categoryKey: "KIRMIZI",
    question: "TRAVMAâ€™da hava yolu kontrolÃ¼ iÃ§in en kritik endikasyonlardan biri hangisidir?",
    options: { A: "Hafif baÅŸ aÄŸrÄ±sÄ±", B: "GKS â‰¤ 8", C: "Ä°ÅŸtahsÄ±zlÄ±k", D: "Bel aÄŸrÄ±sÄ±" },
    answer: "B"
  },
  {
    id: "KIRMIZI-008",
    categoryKey: "KIRMIZI",
    question: "Hiperkalemide membran stabilizasyonu iÃ§in ilk verilen ilaÃ§ hangisidir?",
    options: { A: "Kalsiyum glukonat", B: "Furosemid", C: "Heparin", D: "Metoprolol" },
    answer: "A"
  },
  {
    id: "KIRMIZI-009",
    categoryKey: "KIRMIZI",
    question: "Akut koroner sendromda hayatÄ± tehdit eden mekanik komplikasyonlardan biri hangisidir?",
    options: { A: "Kolelitiazis", B: "Papiller kas rÃ¼ptÃ¼rÃ¼", C: "Otit", D: "SinÃ¼zit" },
    answer: "B"
  },
  {
    id: "KIRMIZI-010",
    categoryKey: "KIRMIZI",
    question: "Aort diseksiyonunda ilk hedeflerden biri hangisidir?",
    options: { A: "AÄŸrÄ±yÄ± artÄ±rmak", B: "NabÄ±z ve tansiyon kontrolÃ¼", C: "Bol sÄ±vÄ± yÃ¼klemek", D: "Sadece antibiyotik" },
    answer: "B"
  },
  {
    id: "KIRMIZI-011",
    categoryKey: "KIRMIZI",
    question: "Akut iskemik inmede trombektomi dÃ¼ÅŸÃ¼nÃ¼lmesinde en kritik unsurlardan biri hangisidir?",
    options: { A: "SaÃ§ tipi", B: "BÃ¼yÃ¼k damar oklÃ¼zyonu varlÄ±ÄŸÄ±", C: "Kan grubu", D: "Boy uzunluÄŸu" },
    answer: "B"
  },
  {
    id: "KIRMIZI-012",
    categoryKey: "KIRMIZI",
    question: "Septik ÅŸokta ilk saat yaklaÅŸÄ±mÄ± iÃ§in doÄŸru seÃ§enek hangisidir?",
    options: { A: "Sadece analjezi", B: "SÄ±vÄ± + erken antibiyotik", C: "Sadece antihistaminik", D: "Bekle-gÃ¶r" },
    answer: "B"
  },
  {
    id: "KIRMIZI-013",
    categoryKey: "KIRMIZI",
    question: "PEA arrestte en Ã¶nemli yaklaÅŸÄ±m hangisidir?",
    options: { A: "Defibrilasyon", B: "Kompresyon + geri dÃ¶ndÃ¼rÃ¼lebilir nedenleri araÅŸtÄ±rma", C: "Sadece atropin", D: "Sadece oksijen" },
    answer: "B"
  },
  {
    id: "KIRMIZI-014",
    categoryKey: "KIRMIZI",
    question: "Akut koroner sendromda ST elevasyonlu MIâ€™da reperfÃ¼zyon iÃ§in temel seÃ§enek hangisidir?",
    options: { A: "Sadece aspirin", B: "Primer PCI / fibrinoliz", C: "Sadece statin", D: "Sadece antibiyotik" },
    answer: "B"
  },
  {
    id: "KIRMIZI-015",
    categoryKey: "KIRMIZI",
    question: "NÃ¶rojenik ÅŸok ile ilgili doÄŸru ifade hangisidir?",
    options: { A: "Her zaman taÅŸikardi", B: "Bradikardi + hipotansiyon gÃ¶rÃ¼lebilir", C: "Sadece ateÅŸ yapar", D: "Hipertansiyon yapar" },
    answer: "B"
  },
  {
    id: "KIRMIZI-016",
    categoryKey: "KIRMIZI",
    question: "Akut adrenal kriz (Addison krizi) tedavisinde temel yaklaÅŸÄ±m hangisidir?",
    options: { A: "Sadece antibiyotik", B: "IV hidrokortizon + sÄ±vÄ±", C: "Sadece diÃ¼retik", D: "Sadece antihistaminik" },
    answer: "B"
  },
  {
    id: "KIRMIZI-017",
    categoryKey: "KIRMIZI",
    question: "Hipotermik hastada aritmi riskini artÄ±ran Ã¶nemli faktÃ¶rlerden biri hangisidir?",
    options: { A: "Nazal O2", B: "Kaba manipÃ¼lasyon", C: "SÄ±cak battaniye", D: "YavaÅŸ Ä±sÄ±tma" },
    answer: "B"
  },
  {
    id: "KIRMIZI-018",
    categoryKey: "KIRMIZI",
    question: "Travmada masif kanama kontrolÃ¼nde ilk basamaklardan biri hangisidir?",
    options: { A: "Turnike/basÄ±nÃ§", B: "Antihistaminik", C: "Antibiyotik tek baÅŸÄ±na", D: "Sadece tetkik beklemek" },
    answer: "A"
  },
  {
    id: "KIRMIZI-019",
    categoryKey: "KIRMIZI",
    question: "Akut kardiyojenik ÅŸokta sÄ±k kullanÄ±lan vazopressÃ¶r/inotrop ajanlardan biri hangisidir?",
    options: { A: "Norepinefrin", B: "Parasetamol", C: "Ibuprofen", D: "Loperamid" },
    answer: "A"
  },
  {
    id: "KIRMIZI-020",
    categoryKey: "KIRMIZI",
    question: "YÃ¼ksek riskli hava yolu Ã¶deminde (Ã¶r. anafilaksi/anjiyoÃ¶dem) en Ã¶nemli Ã¶ncelik hangisidir?",
    options: { A: "Antiemetik vermek", B: "Hava yolunu gÃ¼venceye almak", C: "Diyet dÃ¼zenlemek", D: "Sadece gÃ¶zlem" },
    answer: "B"
  },

  // =========================
  // ğŸ§© BONUS (10 soru) â€” ÅABLON (sen dolduracaksÄ±n)
  // =========================
  {
    id: "BONUS-001",
    categoryKey: "BONUS",
    question: "BONUS SORU 1 (burayÄ± deÄŸiÅŸtir)",
    options: { A: "A", B: "B", C: "C", D: "D" },
    answer: "A"
  },
  {
    id: "BONUS-002",
    categoryKey: "BONUS",
    question: "BONUS SORU 2 (burayÄ± deÄŸiÅŸtir)",
    options: { A: "A", B: "B", C: "C", D: "D" },
    answer: "A"
  },
  {
    id: "BONUS-003",
    categoryKey: "BONUS",
    question: "BONUS SORU 3 (burayÄ± deÄŸiÅŸtir)",
    options: { A: "A", B: "B", C: "C", D: "D" },
    answer: "A"
  },
  {
    id: "BONUS-004",
    categoryKey: "BONUS",
    question: "BONUS SORU 4 (burayÄ± deÄŸiÅŸtir)",
    options: { A: "A", B: "B", C: "C", D: "D" },
    answer: "A"
  },
  {
    id: "BONUS-005",
    categoryKey: "BONUS",
    question: "BONUS SORU 5 (burayÄ± deÄŸiÅŸtir)",
    options: { A: "A", B: "B", C: "C", D: "D" },
    answer: "A"
  },
  {
    id: "BONUS-006",
    categoryKey: "BONUS",
    question: "BONUS SORU 6 (burayÄ± deÄŸiÅŸtir)",
    options: { A: "A", B: "B", C: "C", D: "D" },
    answer: "A"
  },
  {
    id: "BONUS-007",
    categoryKey: "BONUS",
    question: "BONUS SORU 7 (burayÄ± deÄŸiÅŸtir)",
    options: { A: "A", B: "B", C: "C", D: "D" },
    answer: "A"
  },
  {
    id: "BONUS-008",
    categoryKey: "BONUS",
    question: "BONUS SORU 8 (burayÄ± deÄŸiÅŸtir)",
    options: { A: "A", B: "B", C: "C", D: "D" },
    answer: "A"
  },
  {
    id: "BONUS-009",
    categoryKey: "BONUS",
    question: "BONUS SORU 9 (burayÄ± deÄŸiÅŸtir)",
    options: { A: "A", B: "B", C: "C", D: "D" },
    answer: "A"
  },
  {
    id: "BONUS-010",
    categoryKey: "BONUS",
    question: "BONUS SORU 10 (burayÄ± deÄŸiÅŸtir)",
    options: { A: "A", B: "B", C: "C", D: "D" },
    answer: "A"
  }
];

    /***********************
     *  APP STATE
     ***********************/
    const state = {
      teams: [],               // {name, score}
      activeTeamNames: [],     // current stage participants (subset)
      stageIndex: 0,           // 1,2,3
      stageName: '',
      stagePlan: null,         // list of categories to ask
      stageTotalQuestions: 0,
      stageAskedCount: 0,      // non-tiebreak asked count
      tieBreak: false,
      tieCandidates: [],       // team names in tie-break
      currentQuestion: null,
      timer: { seconds:30, remaining:30, interval:null },
      usedQuestionIds: new Set(),
      cutoff: null,            // 4 for stage1, 3 for stage2, 1 for final winner
            tieBreakQuestionsAsked: 0,     // tie-breakte kaÃ§ soru soruldu
      tieSafeNames: [],              // cutoff puanÄ±nÄ±n Ã¼stÃ¼nde kalan "gÃ¼venli" takÄ±mlar
      pendingComp: null,             // { amount:number, names:[...] } -> sonraki aÅŸama baÅŸÄ±nda eklenecek
      tieBreakBaseScores: {},     // tie-break baÅŸlarken adaylarÄ±n skor snapshot'Ä±
tieBreakExtra: {},          // tie-break boyunca adaylarÄ±n kazandÄ±ÄŸÄ± "ek puan" (toplam skora yazÄ±lmayacak)
    };

    const STAGES = [
      null,
      { name: '1.AÅAMA', cutoff: 4, plan: ['YESIL','SARI','SARI','KIRMIZI','BONUS'] },
      { name: '2.AÅAMA', cutoff: 3, plan: ['YESIL','SARI','SARI','KIRMIZI','BONUS'] },
      { name: 'FÄ°NAL',  cutoff: 1, plan: ['YESIL','SARI','SARI','KIRMIZI','BONUS'] },
    ];

// âœ… Sesler
const SND = {
  countdown: new Audio('https://acil42.com/wp-content/uploads/2026/02/30secCountdownSound.mp3'),
  gong:      new Audio('https://acil42.com/wp-content/uploads/2026/02/BellGongSoundEffect.mp3'),
  standby:   new Audio('https://acil42.com/wp-content/uploads/2026/02/StandBySound.mp3'),
};

SND.countdown.preload = 'auto';
SND.gong.preload = 'auto';
SND.standby.preload = 'auto';
SND.standby.loop = true;

function playOneShot(a){
  try{
    a.pause();
    a.currentTime = 0;
    a.play();
  }catch(e){}
}

function startStandby(){
  try{
    SND.standby.currentTime = 0;
    SND.standby.play();
  }catch(e){}
}

function stopStandby(){
  try{
    SND.standby.pause();
    SND.standby.currentTime = 0;
  }catch(e){}
}


    

    /***********************
     *  HELPERS
     ***********************/
    const $ = (id) => document.getElementById(id);

    function showScreen(screenId){
      for(const el of document.querySelectorAll('.screen')) el.classList.remove('active');
      $(screenId).classList.add('active');
    }

    function getTeamsByNames(names){
      return state.teams.filter(t => names.includes(t.name));
    }

    function sortTeamsByScore(names){
      return getTeamsByNames(names)
        .slice()
        .sort((a,b)=> b.score - a.score || a.name.localeCompare(b.name,'tr'));
    }

    function formatStagePills(){
      $('stagePill').classList.remove('d-none');
      $('subStagePill').classList.remove('d-none');
      $('stagePill').textContent = state.stageName;
      $('subStagePill').textContent = state.tieBreak ? 'Tie-break (Bonus)' : 'Normal';
    }

    function updateLiveScoreboard(){
  const sorted = sortTeamsByScore(state.activeTeamNames);
  $('activeTeamsBadge').textContent = `${sorted.length} takÄ±m`;
  const tbody = $('liveScoreBody');
  tbody.innerHTML = '';

  const cutoff = state.cutoff || 0;

  sorted.forEach((t, idx)=>{
    const tr = document.createElement('tr');

    // Mevcut sÄ±ralama renkleri (istersen kaldÄ±rabilirsin)
    if(idx===0) tr.classList.add('rank-1');
    if(idx===1) tr.classList.add('rank-2');
    if(idx===2) tr.classList.add('rank-3');
    if(idx===3) tr.classList.add('rank-4');

    // âœ… Ãœst tur / elenen vurgusu
    if(cutoff > 0){
      if(idx < cutoff){
        tr.classList.add('live-qualify');     // Ã¼st tura Ã§Ä±kÄ±yor
      }else{
        tr.classList.add('live-eliminate');   // eleniyor
      }
    }

    tr.innerHTML = `
      <td class="fw-bold">${idx+1}</td>
      <td class="fw-bold">${escapeHtml(t.name)}</td>
      <td class="text-end fw-bold fs-5">${t.score}</td>
    `;
    tbody.appendChild(tr);
  });
}

function setArenaTheme(catKey){
  const arena = document.getElementById('arenaCard');
  if(!arena) return;

  arena.classList.remove('bg-yesil','bg-sari','bg-kirmizi','bg-bonus','bg-tiebreak');

  // âœ… Tie-break her ÅŸeyin Ã¼stÃ¼nde baskÄ±n olsun
  if(state.tieBreak){
    arena.classList.add('bg-tiebreak');
    return;
  }

  if(catKey === 'YESIL') arena.classList.add('bg-yesil');
  if(catKey === 'SARI') arena.classList.add('bg-sari');
  if(catKey === 'KIRMIZI') arena.classList.add('bg-kirmizi');
  if(catKey === 'BONUS') arena.classList.add('bg-bonus');
}

    
    function escapeHtml(s){
      return (s||'').replace(/[&<>"']/g, m => ({
        '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'
      }[m]));
    }

    function pickRandomQuestion(categoryKey){
      const candidates = QUESTION_BANK.filter(q => q.categoryKey===categoryKey && !state.usedQuestionIds.has(q.id));
      if(candidates.length === 0) return null;
      const q = candidates[Math.floor(Math.random()*candidates.length)];
      state.usedQuestionIds.add(q.id);
      return q;
    }

    function startTimer(){
      stopTimer();
      state.timer.remaining = state.timer.seconds;
      $('timerBig').textContent = state.timer.remaining;
      $('timerBar').style.width = '100%';

      state.timer.interval = setInterval(()=>{
        state.timer.remaining -= 1;
        const pct = Math.max(0, (state.timer.remaining / state.timer.seconds) * 100);
        $('timerBig').textContent = state.timer.remaining;
        $('timerBar').style.width = pct + '%';

        if(state.timer.remaining <= 0){
          stopTimer();
          onTimeUp();
        }
      }, 1000);
    }

    function stopTimer(){
      if(state.timer.interval){
        clearInterval(state.timer.interval);
        state.timer.interval = null;
      }
    }

    function onTimeUp(){
      $('btnShowAnswer').classList.remove('d-none');
      disableOptions(true);
    }

    function disableOptions(disabled){
      ['optA','optB','optC','optD'].forEach(id => $(id).disabled = disabled);
    }

    function resetQuestionButtons(){
      $('btnShowAnswer').classList.add('d-none');
      $('btnEnterPoints').classList.add('d-none');
      $('btnNextQuestion').classList.add('d-none');
    }

    function renderQuestion(q, questionIndexText){
      state.currentQuestion = q;

const cat = CATEGORY[q.categoryKey];

const chip = $('chipCategory');
chip.textContent = cat.label;

// Ã¶nce eski renkleri temizle
chip.classList.remove(
  'text-bg-success',
  'text-bg-warning',
  'text-bg-danger',
  'text-bg-primary'
);

// kategoriye gÃ¶re renk ver
if(cat.key === 'YESIL') chip.classList.add('text-bg-success');
if(cat.key === 'SARI') chip.classList.add('text-bg-warning');
if(cat.key === 'KIRMIZI') chip.classList.add('text-bg-danger');
if(cat.key === 'BONUS') chip.classList.add('text-bg-primary');
      setArenaTheme(cat.key);
      $('txtPoints').textContent = cat.points;
      $('txtQCounter').textContent = questionIndexText;

      $('chipMode').classList.toggle('d-none', !state.tieBreak);

      $('questionText').textContent = q.question;
      $('optA').innerHTML = `<span class="opt-letter">A</span><span>${escapeHtml(q.options.A)}</span>`;
$('optB').innerHTML = `<span class="opt-letter">B</span><span>${escapeHtml(q.options.B)}</span>`;
$('optC').innerHTML = `<span class="opt-letter">C</span><span>${escapeHtml(q.options.C)}</span>`;
$('optD').innerHTML = `<span class="opt-letter">D</span><span>${escapeHtml(q.options.D)}</span>`;

      // reset option styles
      for(const id of ['optA','optB','optC','optD']){
        const btn = $(id);
        btn.style.background = '#fff';
        btn.style.borderColor = 'rgba(0,0,0,.08)';
      }

      disableOptions(true);
resetQuestionButtons();

// âœ… Timer otomatik baÅŸlamasÄ±n
stopTimer();
$('timerBig').textContent = state.timer.seconds;
$('timerBar').style.width = '100%';

// âœ… Butonlar
$('btnStartTimer').classList.remove('d-none');     // sÃ¼reyi baÅŸlat gÃ¶rÃ¼nsÃ¼n
$('btnShowAnswer').classList.add('d-none');
$('btnEnterPoints').classList.add('d-none');
$('btnNextQuestion').classList.add('d-none');

updateLiveScoreboard();
formatStagePills();
    }

    function highlightAnswer(){
      const ans = state.currentQuestion.answer;
      const map = {A:'optA',B:'optB',C:'optC',D:'optD'};
      const correctId = map[ans];

      for(const id of ['optA','optB','optC','optD']){
        $(id).style.background = '#fff';
      }
      const correctBtn = $(correctId);
      correctBtn.style.background = 'rgba(25,135,84,.15)';
      correctBtn.style.borderColor = 'rgba(25,135,84,.6)';

      $('btnEnterPoints').classList.remove('d-none');
      $('btnShowAnswer').classList.add('d-none');
    }

    function buildPointsModal(){
function cssSafe(s){
  return (s || '').toLowerCase().replace(/[^a-z0-9]+/g,'-');
}
      
      const maxPts = CATEGORY[state.currentQuestion.categoryKey].points;
      $('modalMaxPoints').textContent = maxPts;

      const targetNames = state.tieBreak ? state.tieCandidates : state.activeTeamNames;
      const tbody = $('pointsEntryBody');
      tbody.innerHTML = '';

      targetNames.forEach(name=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="fw-bold">${escapeHtml(name)}</td>
          <td class="text-end">
  <div class="btn-group" role="group" aria-label="DoÄŸru YanlÄ±ÅŸ">
    <input type="radio" class="btn-check" name="ans-${cssSafe(name)}" id="w-${cssSafe(name)}" autocomplete="off" data-team="${escapeHtml(name)}" data-correct="0" checked>
    <label class="btn btn-outline-danger fw-bold" for="w-${cssSafe(name)}">YanlÄ±ÅŸ</label>

    <input type="radio" class="btn-check" name="ans-${cssSafe(name)}" id="c-${cssSafe(name)}" autocomplete="off" data-team="${escapeHtml(name)}" data-correct="1">
    <label class="btn btn-outline-success fw-bold" for="c-${cssSafe(name)}">DoÄŸru</label>
  </div>
</td>
        `;
        tbody.appendChild(tr);
      });
    }

    function savePointsFromModal(){
  const pts = CATEGORY[state.currentQuestion.categoryKey].points;

  // Her takÄ±m iÃ§in seÃ§ili radio: data-correct="1" ise doÄŸru
  const radios = $('pointsEntryBody').querySelectorAll('input[type="radio"][data-team]:checked');

        if(state.tieBreak){
    state.tieBreakQuestionsAsked += 1; // âœ… her kaydedilen tie-break = 1 bonus soru
  }

  radios.forEach(r => {
    const name = r.getAttribute('data-team');
    const isCorrect = r.getAttribute('data-correct') === "1";
    if(isCorrect){
  if(state.tieBreak){
    // âœ… Tie-break: toplam skora yazma, sadece "ekstra"ya yaz
    state.tieBreakExtra[name] = (state.tieBreakExtra[name] || 0) + pts;
  }else{
    // âœ… Normal tur: toplam skora yaz
    const team = state.teams.find(t=>t.name===name);
    if(team) team.score += pts;
  }
}
  });

  updateLiveScoreboard();

  $('btnNextQuestion').classList.remove('d-none');
  $('btnEnterPoints').classList.add('d-none');
}

    function startStage(stageIdx, participantNames){
      state.stageIndex = stageIdx;
      state.stageName = STAGES[stageIdx].name;
      state.cutoff = STAGES[stageIdx].cutoff;
      state.stagePlan = STAGES[stageIdx].plan.slice();
      state.stageTotalQuestions = state.stagePlan.length;
      state.stageAskedCount = 0;
      state.tieBreak = false;
      state.tieCandidates = [];
      state.activeTeamNames = participantNames.slice();
            // âœ… Ã–nceki aÅŸamadan tie-break kompanzasyonu varsa, yeni aÅŸama baÅŸÄ±nda uygula
      if(state.pendingComp && state.pendingComp.amount > 0){
        const { amount, names } = state.pendingComp;

        participantNames.forEach(n=>{
          if(names.includes(n)){
            const team = state.teams.find(t=>t.name===n);
            if(team) team.score += amount;
          }
        });

        state.pendingComp = null; // âœ… bir kere uygula
      }

      showScreen('screenQuestion');
      nextQuestion();
    }

    function nextQuestion(){
      resetQuestionButtons();

      let catKey;
      let qCounterText;

      if(state.tieBreak){
        catKey = 'BONUS';
        qCounterText = `Tie-break`;
      }else{
        catKey = state.stagePlan[state.stageAskedCount];
        qCounterText = `${state.stageAskedCount + 1}/${state.stageTotalQuestions}`;
      }

      const q = pickRandomQuestion(catKey);
      if(!q){
        alert('Bu kategoride kullanÄ±labilir soru kalmadÄ±. (Soru bankasÄ±nÄ± geniÅŸletin)');
        return;
      }

      renderQuestion(q, qCounterText);

      if(!state.tieBreak){
        state.stageAskedCount += 1;
      }

      function resetQuestionButtons(){
  $('btnShowAnswer').classList.add('d-none');
  $('btnEnterPoints').classList.add('d-none');
  $('btnNextQuestion').classList.add('d-none');
  $('btnStartTimer')?.classList.remove('d-none'); // âœ…
}
    }

    function computeCutoffTie(names, cutoff){
      const sorted = sortTeamsByScore(names);
      if(sorted.length <= cutoff) return { hasTie:false, tiedNames:[] };

      const cutoffScore = sorted[cutoff-1].score;

      const tiedGroup = sorted.filter(t => t.score === cutoffScore).map(t=>t.name);
      const positions = tiedGroup.map(n => sorted.findIndex(t=>t.name===n));
      const minPos = Math.min(...positions);
      const maxPos = Math.max(...positions);

      const tieAffectsCutoff = (minPos <= cutoff-1) && (maxPos >= cutoff);
      return { hasTie: tieAffectsCutoff, tiedNames: tieAffectsCutoff ? tiedGroup : [] };
    }

    function showScoreboardForStage(){
  startStandby();
  showScreen('screenScoreboard');

  const sorted = sortTeamsByScore(state.activeTeamNames);
  const cutoff = state.cutoff;

  $('scoreboardTitle').textContent = `${state.stageName} Puan Tablosu`;
  if(state.stageIndex === 1){
    $('scoreboardSubtitle').textContent = `Ä°lk ${cutoff} takÄ±m 2.AÅAMAYA Ã§Ä±kar. Cutoff eÅŸitliÄŸi varsa bonus tie-break yapÄ±lÄ±r.`;
  }else if(state.stageIndex === 2){
    $('scoreboardSubtitle').textContent = `Ä°lk ${cutoff} takÄ±m FÄ°NALE Ã§Ä±kar. Cutoff eÅŸitliÄŸi varsa bonus tie-break yapÄ±lÄ±r.`;
  }else{
    $('scoreboardSubtitle').textContent = `Final sonuÃ§larÄ±. EÅŸitlik varsa bonus tie-break ile ÅŸampiyon belirlenir.`;
  }

  const tbody = $('finalScoreBody');
  tbody.innerHTML = '';

  sorted.forEach((t, idx)=>{
    const isQualified = idx < cutoff;
    let status = isQualified ? 'Ãœst Tura' : 'Elendi';
    if(state.stageIndex === 3) status = (idx===0 ? 'ÅAMPÄ°YON' : 'â€”');

    const tr = document.createElement('tr');
    if(idx===0) tr.classList.add('rank-1');
    if(idx===1) tr.classList.add('rank-2');
    if(idx===2) tr.classList.add('rank-3');
    if(idx===3) tr.classList.add('rank-4');

    tr.innerHTML = `
      <td class="fw-bold">${idx+1}</td>
      <td class="fw-bold">${escapeHtml(t.name)}</td>
      <td class="text-end fw-bold fs-5">${t.score}</td>
      <td class="text-end">
        <span class="badge ${status==='Ãœst Tura' ? 'text-bg-success' :
                            status==='Elendi' ? 'text-bg-secondary' :
                            status==='ÅAMPÄ°YON' ? 'text-bg-success' : 'text-bg-light'}">
          ${status}
        </span>
      </td>
    `;
    tbody.appendChild(tr);
  });

  // tie check
  const tie = computeCutoffTie(state.activeTeamNames, cutoff);
  const tieInfo = $('tieInfo');

  if(tie.hasTie){
    const cutoffScore = sorted[cutoff-1].score;

    state.tieBreak = true;
    state.tieCandidates = tie.tiedNames.slice();

    state.tieBreakQuestionsAsked = 0;
    state.tieSafeNames = sorted
      .filter(t => t.score > cutoffScore)
      .map(t => t.name);

    // âœ… Tie-break baÅŸlarken: adaylarÄ±n skorunu snapshot al, ek puanlarÄ± sÄ±fÄ±rla
state.tieBreakBaseScores = {};
state.tieBreakExtra = {};
state.tieCandidates.forEach(n=>{
  const team = state.teams.find(t=>t.name===n);
  state.tieBreakBaseScores[n] = team ? team.score : 0;
  state.tieBreakExtra[n] = 0;
});

    stopStandby();
    showScreen('screenQuestion');
    nextQuestion();
    return;
  }

  // EÄŸer tie yoksa normalde DEVAM butonu gÃ¶rÃ¼nÃ¼r olmalÄ±
  $('btnProceedNextStage').classList.toggle('d-none', state.stageIndex === 3);
  $('tieInfo').classList.add('d-none');
} // âœ… showScoreboardForStage BURADA BÄ°TER


// âœ… BUNLAR DIÅARIDA OLMALI (GLOBAL SCOPE)
function proceedFromScoreboard(){
  stopStandby();
  const sorted = sortTeamsByScore(state.activeTeamNames);

  if(state.stageIndex === 1){
    const nextNames = sorted.slice(0, STAGES[1].cutoff).map(t=>t.name);
    startStage(2, nextNames);
  }else if(state.stageIndex === 2){
    const nextNames = sorted.slice(0, STAGES[2].cutoff).map(t=>t.name);
    startStage(3, nextNames);
  }else{
    alert(`Åampiyon: ${sorted[0]?.name || '-'}`);
  }
}

function resetAll(){
  stopTimer();
  state.teams = [];
  state.activeTeamNames = [];
  state.stageIndex = 0;
  state.stageName = '';
  state.stagePlan = null;
  state.stageTotalQuestions = 0;
  state.stageAskedCount = 0;
  state.tieBreak = false;
  state.tieCandidates = [];
  state.currentQuestion = null;
  state.usedQuestionIds = new Set();

  $('stagePill').classList.add('d-none');
  $('subStagePill').classList.add('d-none');
  $('teamTextarea').value = '';
  $('btnBeginStage1').disabled = true;

  // âš ï¸ burasÄ± istersen: QUESTION_BANK'i placeholder'a Ã§evirmek yerine aynÄ± kalsÄ±n
  // QUESTION_BANK = generatePlaceholderQuestions();

  showScreen('screenWelcome');
}
    /***********************
     *  EVENTS
     ***********************/
    $('btnStart').addEventListener('click', ()=> showScreen('screenTeams'));

    $('btnStartTimer').addEventListener('click', ()=>{
  $('btnStartTimer').classList.add('d-none');

  stopStandby();                 // âœ… standby kapansÄ±n
  playOneShot(SND.countdown);    // (playOneShot zaten resetliyor)
  playOneShot(SND.gong);

  startTimer();
});

    $('btnDemoFill').addEventListener('click', ()=>{
      $('teamTextarea').value = [
        'Konya City',
        'Ankara ResÃ¼s',
        'Ä°zmir Åok',
        'Bursa Monitor',
        'Antalya Triage',
        'Samsun USG',
        'Adana Travma',
        'Ä°stanbul EKG'
      ].join('\\n');
      showScreen('screenTeams');
    });

    $('btnClearTeams').addEventListener('click', ()=>{
      $('teamTextarea').value = '';
      $('btnBeginStage1').disabled = true;
    });

    $('btnParseTeams').addEventListener('click', ()=>{
      const lines = $('teamTextarea').value
        .split('\\n')
        .map(s=>s.trim())
        .filter(Boolean);

      const uniq = [];
      for(const n of lines){
        if(!uniq.includes(n)) uniq.push(n);
      }

      state.teams = uniq.map(name => ({ name, score:0 }));
      $('btnBeginStage1').disabled = state.teams.length < 2;
      alert(`TakÄ±mlar kaydedildi: ${state.teams.length} takÄ±m`);
    });

    $('btnBeginStage1').addEventListener('click', ()=>{
      state.teams.forEach(t=> t.score = 0);
      state.usedQuestionIds = new Set();
      state.tieBreak = false;
      state.tieCandidates = [];

      const participantNames = state.teams.map(t=>t.name);
      startStage(1, participantNames);
    });

    $('btnShowAnswer').addEventListener('click', ()=>{
  playOneShot(SND.gong);
  highlightAnswer();
});

    $('btnEnterPoints').addEventListener('click', ()=>{
  buildPointsModal();
  startStandby();
});

    const pointsModalEl = document.getElementById('pointsModal');
pointsModalEl.addEventListener('hidden.bs.modal', ()=>{
  stopStandby();
});

    $('btnSavePoints').addEventListener('click', ()=>{
      savePointsFromModal();

      

if(state.tieBreak){
  // âœ… Tie-break sÄ±ralamasÄ±: sadece ekstra puana gÃ¶re
  const candSorted = state.tieCandidates
    .map(n => ({
      name: n,
      extra: state.tieBreakExtra[n] || 0
    }))
    .sort((a,b)=> b.extra - a.extra || a.name.localeCompare(b.name,'tr'));

  const topExtra = candSorted[0]?.extra ?? 0;
  const allSame = candSorted.every(x => x.extra === topExtra);

  if(!allSame){
    // âœ… Tie-break Ã§Ã¶zÃ¼ldÃ¼: toplam skorlarÄ± geri garanti et (zaten deÄŸiÅŸmedi ama net olsun)
    state.tieCandidates.forEach(n=>{
      const team = state.teams.find(t=>t.name===n);
      if(team) team.score = state.tieBreakBaseScores[n] ?? team.score;
    });

    // âœ… Tie-break temizle
    state.tieBreak = false;
    state.tieCandidates = [];
    state.tieSafeNames = [];
    state.tieBreakQuestionsAsked = 0;
    state.pendingComp = null; // artÄ±k kompanzasyona gerek yok
    state.tieBreakBaseScores = {};
    state.tieBreakExtra = {};
  }
}
    });

    $('btnNextQuestion').addEventListener('click', ()=>{
      // Normal tur sorularÄ± bitti ise tabloya geÃ§
      if(!state.tieBreak && state.stageAskedCount >= state.stageTotalQuestions){
        showScoreboardForStage();
        return;
      }
      // Tie-break bittiyse ve normal tur zaten bittiyse tablo
      if(!state.tieBreak && state.stageAskedCount >= state.stageTotalQuestions){
        showScoreboardForStage();
        return;
      }
      nextQuestion();
    });

    $('btnProceedNextStage').addEventListener('click', proceedFromScoreboard);

    $('btnBackToTeams').addEventListener('click', ()=>{
      stopStandby();
      resetAll();
      showScreen('screenTeams');
    });

    

    document.addEventListener('visibilitychange', ()=>{
      if(document.hidden) stopTimer();
    });

    // Ä°lk aÃ§Ä±lÄ±ÅŸta
    updateLiveScoreboard();
  </script>
</body>
</html>
